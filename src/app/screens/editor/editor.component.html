<app-navigator-bar title="Editor" [actions]="navigatorActions" />

<form [formGroup]="deckForm" class="expand-container hidden-scroll">
  <!-- TODO: Create text input component -->
  <label for="name">
    Name
    <input
      type="text"
      id="name"
      formControlName="name"
      placeholder="Example: JLPT N5 🍡"
    />
    <small
      class="pico-color-red-500"
      [hidden]="deckForm.get('name')?.valid || deckForm.get('name')?.pristine"
    >
      Field not valid
    </small>
  </label>

  <ng-container
    *ngIf="
      loadingDeck$ | async;
      then alreadyLoadedBlock;
      else loadingSpinnerBlock
    "
  />
</form>

<ng-template #alreadyLoadedBlock>
  <ng-container *ngIf="hasItems; else emptyListBlock">
    <app-cards-table class="expand-container scrollable"></app-cards-table>
    <footer>
      <button
        type="button"
        [disabled]="!deckForm.valid"
        [routerLink]="'/'"
        (click)="handleCreateDeck()"
      >
        {{ submitButtonLabel }}
      </button>
    </footer>
  </ng-container>
</ng-template>

<ng-template #loadingSpinnerBlock>
  <article aria-busy="true">Loading deck...</article>
</ng-template>

<ng-template #emptyListBlock>
  <article>
    <p>🛸<b>Oops!</b> It seems this deck is empty</p>
    <button (click)="handleOpenDialog(-1)">Start writing cards</button>
    <hr />
    <p>Or import an existing .csv file</p>
    <input type="file" accept=".csv" (change)="onCsvFileSelected($event)" />
  </article>
</ng-template>
